<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code Metrics Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI',
                Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            color: white;
            margin-bottom: 30px;
            text-align: center;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        .metric-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 24px rgba(0,0,0,0.15);
        }
        .metric-title {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .metric-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }
        .metric-unit {
            color: #999;
            font-size: 0.9em;
        }
        .metric-trend {
            font-size: 0.85em;
            padding: 5px 10px;
            border-radius: 5px;
            display: inline-block;
            margin-top: 10px;
        }
        .trend-up {
            background: #d4edda;
            color: #155724;
        }
        .trend-down {
            background: #f8d7da;
            color: #721c24;
        }
        .charts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
        }
        .chart-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }
        .chart-title {
            font-size: 1.2em;
            margin-bottom: 15px;
            color: #333;
        }
        canvas {
            max-height: 300px;
        }
        .last-updated {
            text-align: center;
            color: rgba(255,255,255,0.7);
            margin-top: 20px;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Code Metrics Dashboard</h1>

        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-title">Coverage</div>
                <div class="metric-value" id="coverage-value">0%</div>
                <div class="metric-unit">Lines covered</div>
                <div class="metric-trend trend-up" id="coverage-trend"></div>
            </div>
            <div class="metric-card">
                <div class="metric-title">Complexity</div>
                <div class="metric-value" id="complexity-value">0</div>
                <div class="metric-unit">Cyclomatic complexity</div>
                <div class="metric-trend trend-down" id="complexity-trend"></div>
            </div>
            <div class="metric-card">
                <div class="metric-title">Maintainability</div>
                <div class="metric-value" id="maintainability-value">0</div>
                <div class="metric-unit">MI Score (0-100)</div>
                <div class="metric-trend trend-up" id="maintainability-trend">
                </div>
            </div>
            <div class="metric-card">
                <div class="metric-title">Duplication</div>
                <div class="metric-value" id="duplication-value">0%</div>
                <div class="metric-unit">Duplicate code</div>
                <div class="metric-trend trend-down" id="duplication-trend">
                </div>
            </div>
            <div class="metric-card">
                <div class="metric-title">Ruff Score</div>
                <div class="metric-value" id="ruff-value">0/10</div>
                <div class="metric-unit">Code quality</div>
                <div class="metric-trend trend-up" id="ruff-trend"></div>
            </div>
            <div class="metric-card">
                <div class="metric-title">Security Issues</div>
                <div class="metric-value" id="security-value">0</div>
                <div class="metric-unit">Vulnerabilities found</div>
                <div class="metric-trend trend-down" id="security-trend"></div>
            </div>
        </div>

        <div class="charts">
            <div class="chart-container">
                <div class="chart-title">Coverage Over Time</div>
                <canvas id="coverageChart"></canvas>
            </div>
            <div class="chart-container">
                <div class="chart-title">Complexity Over Time</div>
                <canvas id="complexityChart"></canvas>
            </div>
            <div class="chart-container">
                <div class="chart-title">Maintainability Over Time</div>
                <canvas id="maintainabilityChart"></canvas>
            </div>
            <div class="chart-container">
                <div class="chart-title">Quality Metrics</div>
                <canvas id="qualityChart"></canvas>
            </div>
        </div>

        <div class="last-updated">
            Last updated: <span id="last-updated"></span>
        </div>
    </div>

    <script>
        const metricsData = [{"timestamp": "2025-11-21T15:35:33.880258", "commit_sha": "999be57", "coverage": 0.0, "complexity": 0, "maintainability": 0, "duplication": 0.0, "security_issues": 10, "ruff_score": 0}, {"timestamp": "2025-11-21T15:42:14.318767", "commit_sha": "4cf2aa0", "coverage": 0.0, "complexity": 0, "maintainability": 0, "duplication": 0.0, "security_issues": 10, "ruff_score": 0}, {"timestamp": "2025-11-21T16:04:57.821651", "commit_sha": "b706515", "coverage": 0.0, "complexity": 0, "maintainability": 0, "duplication": 0.0, "security_issues": 11, "ruff_score": 0}, {"timestamp": "2025-11-21T16:15:10.094741", "commit_sha": "8bbaeea", "coverage": 0.0, "complexity": 0, "maintainability": 0, "duplication": 0.0, "security_issues": 11, "ruff_score": 0}, {"timestamp": "2025-11-21T16:28:27.430429", "commit_sha": "ce0cf2d", "coverage": 0.0, "complexity": 0, "maintainability": 0, "duplication": 0.0, "security_issues": 11, "ruff_score": 0}, {"timestamp": "2025-11-21T16:47:27.560985", "commit_sha": "b50faf1", "coverage": 0.0, "complexity": 0, "maintainability": 0, "duplication": 0.0, "security_issues": 11, "ruff_score": 0}, {"timestamp": "2025-11-21T16:52:20.652123", "commit_sha": "94f754d", "coverage": 0.0, "complexity": 0, "maintainability": 0, "duplication": 0.0, "security_issues": 11, "ruff_score": 0}, {"timestamp": "2025-11-21T16:58:49.225056", "commit_sha": "f9cbd7c", "coverage": 0.0, "complexity": 0, "maintainability": 0, "duplication": 0.0, "security_issues": 11, "ruff_score": 0}, {"timestamp": "2025-11-21T11:14:38.173658", "commit_sha": "c16b53b", "coverage": 70.34, "complexity": 0, "maintainability": 0, "duplication": 0, "security_issues": 0, "ruff_score": 0}, {"timestamp": "2025-11-21T11:15:51.480660", "commit_sha": "c16b53b", "coverage": 70.34, "complexity": 0, "maintainability": 0, "duplication": 0, "security_issues": 0, "ruff_score": 0}, {"timestamp": "2025-11-21T11:33:20.890798", "commit_sha": "e0382a9", "coverage": 70.34, "complexity": 0, "maintainability": 0, "duplication": 0, "ruff_score": 10.0, "security_issues": 0}, {"timestamp": "2025-11-21T12:00:05.518121", "commit_sha": "e0382a9", "coverage": 70.34, "complexity": 0, "maintainability": 0, "duplication": 0, "ruff_score": 10, "security_issues": 0}, {"timestamp": "2025-11-21T12:00:45.582507", "commit_sha": "e0382a9", "coverage": 70.34, "complexity": 0, "maintainability": 0, "duplication": 0, "ruff_score": 10, "security_issues": 0}, {"timestamp": "2025-11-21T17:17:15.960508", "commit_sha": "e0382a9", "coverage": 70.34, "complexity": 0, "maintainability": 0, "duplication": 0.0, "pylint_score": 0, "security_issues": 11}, {"timestamp": "2025-11-21T18:32:11.181592", "commit_sha": "df3ce19", "coverage": 70.34, "complexity": 0, "maintainability": 0, "duplication": 0.0, "ruff_score": 10, "security_issues": 11}, {"timestamp": "2025-11-21T12:36:23.851110", "commit_sha": "73bbd6e", "coverage": 70.34, "complexity": 3.32, "maintainability": 58.65, "duplication": 4.43, "ruff_score": 10, "security_issues": 0}, {"timestamp": "2025-11-21T18:39:25.208493", "commit_sha": "87f5bf2", "coverage": 70.34, "complexity": 3.32, "maintainability": 58.77, "duplication": 4.43, "ruff_score": 10, "security_issues": 0}, {"timestamp": "2025-11-21T18:50:49.620380", "commit_sha": "43907f6", "coverage": 70.34, "complexity": 3.32, "maintainability": 58.77, "duplication": 4.43, "ruff_score": 10, "security_issues": 0}, {"timestamp": "2025-11-21T19:16:25.333565", "commit_sha": "5bbf486", "coverage": 70.34, "complexity": 3.32, "maintainability": 58.77, "duplication": 4.43, "ruff_score": 10, "security_issues": 0}, {"timestamp": "2025-11-21T19:24:01.648697", "commit_sha": "f933248", "coverage": 70.34, "complexity": 3.32, "maintainability": 58.77, "duplication": 4.43, "ruff_score": 10, "security_issues": 0}, {"timestamp": "2025-11-21T19:25:34.363179", "commit_sha": "915b42b", "coverage": 70.34, "complexity": 3.32, "maintainability": 58.77, "duplication": 4.43, "ruff_score": 10, "security_issues": 0}, {"timestamp": "2025-11-21T21:06:58.033153", "commit_sha": "07d917b", "coverage": 70.34, "complexity": 3.32, "maintainability": 58.77, "duplication": 4.43, "ruff_score": 10, "security_issues": 0}, {"timestamp": "2025-11-21T21:08:32.210215", "commit_sha": "d6e9594", "coverage": 70.34, "complexity": 3.32, "maintainability": 58.77, "duplication": 4.43, "ruff_score": 10, "security_issues": 0}, {"timestamp": "2025-11-29T23:24:51.846301", "commit_sha": "4965256", "coverage": 0.0, "complexity": 3.01, "maintainability": 59.37, "duplication": 4.34, "ruff_score": 9.98, "security_issues": 0}, {"timestamp": "2025-11-30T04:34:57.099837", "commit_sha": "68e03ee", "coverage": 0.0, "complexity": 2.9, "maintainability": 60.04, "duplication": 4.21, "ruff_score": 10, "security_issues": 0}, {"timestamp": "2025-11-30T04:36:56.526328", "commit_sha": "0c5ef35", "coverage": 0.0, "complexity": 2.9, "maintainability": 60.04, "duplication": 4.21, "ruff_score": 10, "security_issues": 0}, {"timestamp": "2025-11-29T22:43:57.185898", "commit_sha": "32c0749", "coverage": 73.06, "complexity": 2.9, "maintainability": 59.94, "duplication": 4.21, "ruff_score": 10, "security_issues": 0}, {"timestamp": "2025-11-30T19:42:47.730993", "commit_sha": "16c809f", "coverage": 73.06, "complexity": 2.9, "maintainability": 60.04, "duplication": 4.21, "ruff_score": 10, "security_issues": 0}, {"timestamp": "2025-11-30T19:44:27.922298", "commit_sha": "5318eb5", "coverage": 73.06, "complexity": 2.9, "maintainability": 60.04, "duplication": 4.21, "ruff_score": 10, "security_issues": 0}, {"timestamp": "2025-12-04T06:01:33.356301", "commit_sha": "b35490e", "coverage": 73.06, "complexity": 3.14, "maintainability": 60.26, "duplication": 4.11, "ruff_score": 10, "security_issues": 0}, {"timestamp": "2025-12-04T06:03:16.392404", "commit_sha": "5ab0811", "coverage": 73.06, "complexity": 3.14, "maintainability": 60.26, "duplication": 4.11, "ruff_score": 10, "security_issues": 0}, {"timestamp": "2025-12-05T15:47:44.861864", "commit_sha": "5423055", "coverage": 73.06, "complexity": 3.14, "maintainability": 60.26, "duplication": 4.11, "ruff_score": 10, "security_issues": 0}, {"timestamp": "2025-12-05T15:49:16.822292", "commit_sha": "474f8a2", "coverage": 73.06, "complexity": 3.14, "maintainability": 60.26, "duplication": 4.11, "ruff_score": 10, "security_issues": 0}, {"timestamp": "2025-12-05T16:50:55.304094", "commit_sha": "7c0eb46", "coverage": 73.06, "complexity": 3.14, "maintainability": 60.26, "duplication": 4.11, "ruff_score": 10, "security_issues": 0}, {"timestamp": "2025-12-05T16:52:39.569566", "commit_sha": "ddbf04f", "coverage": 73.06, "complexity": 3.14, "maintainability": 60.26, "duplication": 4.11, "ruff_score": 10, "security_issues": 0}, {"timestamp": "2026-01-13T03:01:56.497601", "commit_sha": "cff74a4", "coverage": 73.06, "complexity": 3.14, "maintainability": 60.26, "duplication": 4.11, "ruff_score": 10, "security_issues": 0}];

        function calculateTrend(values) {
            if (values.length < 2) return 0;
            const recent = values.slice(-5);
            const avg1 = recent.slice(0, 2).reduce((a, b) => a + b, 0) / 2;
            const avg2 = recent.slice(-2).reduce((a, b) => a + b, 0) / 2;
            return avg2 - avg1;
        }

        function updateMetrics() {
            if (metricsData.length === 0) return;

            const latest = metricsData[metricsData.length - 1];

            document.getElementById('coverage-value').textContent =
                latest.coverage + '%';
            document.getElementById('complexity-value').textContent =
                latest.complexity;
            document.getElementById('maintainability-value').textContent =
                latest.maintainability;
            document.getElementById('duplication-value').textContent =
                latest.duplication + '%';
            document.getElementById('ruff-value').textContent =
                latest.ruff_score + '/10';
            document.getElementById('security-value').textContent =
                latest.security_issues;

            const date = new Date(latest.timestamp);
            document.getElementById('last-updated').textContent =
                date.toLocaleString();

            const coverageValues = metricsData.map(m => m.coverage);
            const complexityValues = metricsData.map(m => m.complexity);
            const maintainabilityValues =
                metricsData.map(m => m.maintainability);
            const securityValues = metricsData.map(m => m.security_issues);

            showTrend('coverage-trend', calculateTrend(coverageValues), 'up');
            showTrend('complexity-trend',
                calculateTrend(complexityValues), 'down');
            showTrend('maintainability-trend',
                calculateTrend(maintainabilityValues), 'up');
            showTrend('duplication-trend',
                calculateTrend(metricsData.map(m => m.duplication)), 'down');
            showTrend('ruff-trend',
                calculateTrend(metricsData.map(m => m.ruff_score)), 'up');
            showTrend('security-trend',
                calculateTrend(securityValues), 'down');
        }

        function showTrend(elementId, trend, preferredDirection) {
            const element = document.getElementById(elementId);
            const isPositive = (preferredDirection === 'up' && trend > 0) ||
                (preferredDirection === 'down' && trend < 0);
            const arrow = trend > 0 ? '↑' : '↓';
            element.textContent = arrow + ' ' + Math.abs(trend).toFixed(2);
            element.className = 'metric-trend ' +
                (isPositive ? 'trend-up' : 'trend-down');
        }

        function createCharts() {
            if (metricsData.length === 0) return;

            const labels = metricsData.map((m, i) => i + 1);
            const coverage = metricsData.map(m => m.coverage);
            const complexity = metricsData.map(m => m.complexity);
            const maintainability = metricsData.map(m => m.maintainability);
            const ruff = metricsData.map(m => m.ruff_score);
            const security = metricsData.map(m => m.security_issues);

            new Chart(document.getElementById('coverageChart'), {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Coverage %',
                        data: coverage,
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {display: true}
                    },
                    scales: {
                        y: {min: 0, max: 100}
                    }
                }
            });

            new Chart(document.getElementById('complexityChart'), {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Avg Complexity',
                        data: complexity,
                        borderColor: '#f093fb',
                        backgroundColor: 'rgba(240, 147, 251, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {display: true}
                    }
                }
            });

            new Chart(document.getElementById('maintainabilityChart'), {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Maintainability Index',
                        data: maintainability,
                        borderColor: '#4facfe',
                        backgroundColor: 'rgba(79, 172, 254, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {display: true}
                    },
                    scales: {
                        y: {min: 0, max: 100}
                    }
                }
            });

            new Chart(document.getElementById('qualityChart'), {
                type: 'radar',
                data: {
                    labels: ['Coverage', 'Complexity', 'Maintainability',
                        'Security', 'Ruff'],
                    datasets: [{
                        label: 'Latest Metrics',
                        data: [
                            coverage[coverage.length - 1],
                            (10 - complexity[complexity.length - 1]),
                            maintainability[maintainability.length - 1],
                            (10 - Math.min(security[security.length - 1], 10)),
                            ruff[ruff.length - 1] * 10
                        ],
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.2)',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        r: {
                            min: 0,
                            max: 100
                        }
                    }
                }
            });
        }

        updateMetrics();
        createCharts();
    </script>
</body>
</html>